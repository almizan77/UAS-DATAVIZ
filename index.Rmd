---
title: "UAS"
author: "Latif Almizan-Institut Teknologi Statistika dan Bisnis Muhammadiyah"
date: "`r Sys.Date()`"
output: 
  html_document:
    theme: flatly
    higlight: zenburn
    toc: true
    toc_float:
      collapsed: true
    df_print: paged
bibliography: references.bib
---
**Nama Tugas : Visualisasi Data**
**Nama       : Latif ALmizan** 
**Nim        : A320230022**

**TUJUAN DARI ANALISIS INI ADALAH UNTUK MENGANALISIS SEBUAH DATA YANG BERISI DISTRIBUSI ANGKA HARAPAN HIDUP, PENDAPATAN PER KAPITA DAN ANGKA HARAPAN HIDUP, HEATMAP UNTUK KORELASI ANTARA VARIABEL NUMERIK, SCATTER PLOT INTERAKTIF MENGGUNAKAN PLOTLY.**

# Grafik Univariat dengan Histogram
```{r}
# 1. Sebelum membuat grafik, kita harus memuat dan menginstal library ggplot2:
library(readxl)
library(ggplot2)
library(reshape2)
library(ggcorrplot)
```
```{r}
library(readxl)
data <- read_excel("Data.xlsx")
View(Data)
```

Histogram ini menunjukkan distribusi Angka Harapan Hidup dalam dataset.

Jika distribusi berbentuk simetris, berarti nilai-nilai tersebar merata.
Jika miring ke kiri atau ke kanan, berarti ada dominasi nilai tertentu.
Puncak (mode) menunjukkan kelompok nilai yang paling sering muncul.

# Grafik 1: Histogram Angka Harapan Hidup (Univariat)
```{r}
# digunakan untuk menentukan dataset dan variabel x yang akan dipetakan. Dalam hal ini, kita ingin memvisualisasikan Angka Harapan Hidup.
ggplot(data, aes(x = Angka_Harapan_Hidup)) +
# digunakan untuk membuat histogram. Beberapa parameter yang digunakan:disini saya menggunakan binwidth = 2
  geom_histogram(binwidth = 2, fill = "blue", alpha = 0.7, color = "black") +
# Fungsi labs() digunakan untuk memberi judul pada grafik dan label pada sumbu X dan Y serta Title untuk meberikan judul pada grafik.
  labs(title = "Distribusi Angka Harapan Hidup", x = "Angka Harapan Hidup", y = "Frekuensi") +
# digunakan untuk menyederhanakan tampilan grafik agar lebih bersih dan profesional.
  theme_minimal()
```

Scatter plot ini menggambarkan hubungan antara Pendapatan per Kapita dan Angka Harapan Hidup.
Semakin tinggi Pendapatan per Kapita, semakin tinggi Angka Harapan Hidup → indikasi adanya korelasi positif.
Warna menunjukkan Benua, sehingga bisa dibandingkan antar wilayah.
Penggunaan skala logaritmik membantu mengatasi distribusi data yang terlalu lebar.

# Grafik 2: Scatter Plot Pendapatan per Kapita vs Angka Harapan Hidup (Bivariat)
```{r}
# Fungsi ggplot(data, aes(x = Pendapatan_per_kapita, y = Angka_Harapan_Hidup, color = Benua)) digunakan untuk:data → Menggunakan dataset yang telah dimuat,  aes() → Mendefinisikan variabel sumbu x sebagai Pendapatan_per_kapita dan y sebagai Angka_Harapan_Hidup, color = Benua → Memberi warna pada titik berdasarkan kategori Benua.
ggplot(data, aes(x = Pendapatan_per_kapita, y = Angka_Harapan_Hidup, color = Benua)) +
# Fungsi geom_point() digunakan untuk membuat titik-titik dalam scatter plot, alpha = 0.6 → Transparansi 60% agar titik yang tumpang tindih lebih mudah terlihat.
  geom_point(alpha = 0.6) +
# Fungsi scale_x_log10() digunakan karena Pendapatan per Kapita biasanya memiliki rentang nilai yang besar.Dengan skala log, distribusi data lebih seimbang dan pola hubungan lebih mudah diamati.
  scale_x_log10() +  # Menggunakan skala log pada sumbu x
# Fungsi labs() digunakan untuk memberikan informasi tambahan pada grafik, title = "Pendapatan per Kapita vs. Angka Harapan Hidup" → Memberikan judul pada grafik, x = "Pendapatan per Kapita (Log Scale)" → Label untuk sumbu X, y = "Angka Harapan Hidup" → Label untuk sumbu Y.
  labs(title = "Pendapatan per Kapita vs. Angka Harapan Hidup",
       x = "Pendapatan per Kapita (Log Scale)",
       y = "Angka Harapan Hidup") +
#Fungsi theme_minimal() digunakan untuk membuat tampilan grafik lebih bersih dan profesional.
  theme_minimal()
```

Scatter plot ini menggambarkan hubungan antara Pendapatan per Kapita dan Angka Harapan Hidup.
Semakin tinggi Pendapatan per Kapita, semakin tinggi Angka Harapan Hidup → indikasi adanya korelasi positif.
Warna menunjukkan Benua, sehingga bisa dibandingkan antar wilayah.
Penggunaan skala logaritmik membantu mengatasi distribusi data yang terlalu lebar.

# Grafik 3: Heatmap Korelasi antar Variabel (Multivariat)
```{r}
# Menampilkan beberapa baris pertama data
head(data)

# Memilih hanya variabel numerik untuk analisis korelasi
num_vars <- data[, sapply(data, is.numeric)]

# Menghitung korelasi antar variabel numerik
cor_matrix <- cor(num_vars, use = "complete.obs")

# Membuat heatmap korelasi dengan ggcorrplot
ggcorrplot(cor_matrix, 
           method = "circle", 
           type = "lower", 
           lab = TRUE, 
           title = "Matriks Korelasi Variabel Numerik")

# Scatter plot: Angka Harapan Hidup vs Pendapatan per Kapita, dengan warna berdasarkan Benua
ggplot(data, aes(x = Pendapatan_per_kapita, y = Angka_Harapan_Hidup, color = Benua)) +
  geom_point(alpha = 0.7) +
  scale_x_log10() +  # Skala log untuk menangani perbedaan skala besar
  labs(title = "Hubungan antara Pendapatan per Kapita dan Angka Harapan Hidup",
       x = "Pendapatan per Kapita (Log Scale)",
       y = "Angka Harapan Hidup") +
  theme_minimal()

# Scatter plot matrix untuk variabel numerik (bentuk long untuk ggplot2)
melted_data <- melt(num_vars)
ggplot(melted_data, aes(x = value)) +
  geom_histogram(bins = 20, fill = "blue", alpha = 0.6) +
  facet_wrap(~variable, scales = "free") +
  labs(title = "Distribusi Variabel Numerik dalam Dataset") +
  theme_minimal()
```
```{r}
# Karena korelasi hanya berlaku untuk variabel numerik, kita harus memilih kolom yang sesuai dari dataset.
num_vars <- data[, c("Angka_Harapan_Hidup", "Pendapatan_per_kapita", "Populasi", "Jumlah_anak")]
#Menggunakan fungsi cor() untuk menghitung korelasi antar variabel numerik:   use = "complete.obs" → Mengabaikan nilai NA (jika ada).
cor_matrix <- cor(num_vars, use = "complete.obs")
```

Matriks korelasi menunjukkan hubungan antar variabel numerik dalam dataset.
Jika nilai korelasi mendekati +1, berarti hubungan positif kuat (misalnya, Pendapatan per Kapita dan Angka Harapan Hidup).
Jika mendekati -1, berarti hubungan negatif kuat.
Jika mendekati 0, berarti tidak ada korelasi yang signifikan.

# Grafik 4: Scatter Plot dengan Facet Grid (Pengganti Grafik Interaktif)
```{r}
# Fungsi ggplot(data, aes(x = Pendapatan_per_kapita, y = Angka_Harapan_Hidup, color = Benua)) digunakan untuk:  data → Menggunakan dataset yang telah dimuat.  aes() → Mendefinisikan: sumbu x → Pendapatan_per_kapita  sumbu y → Angka_Harapan_Hidup  color = Benua → Memberi warna pada titik berdasarkan kategori Benua.
ggplot(data, aes(x = Pendapatan_per_kapita, y = Angka_Harapan_Hidup, color = Benua)) +
# Fungsi geom_point() digunakan untuk menampilkan titik-titik dalam scatter plot. alpha = 0.6 → Transparansi 60% agar titik yang tumpang tindih lebih mudah terlihat. 
  geom_point(alpha = 0.6) +
# Pendapatan per Kapita memiliki rentang nilai yang besar, sehingga lebih mudah dianalisis dengan skala logaritmik:
  scale_x_log10() +
#Karena ada banyak titik data, kita bisa memisahkan scatter plot berdasarkan Benua menggunakan facet_wrap(~Benua). Setiap Benua akan memiliki sub-plot sendiri, sehingga pola hubungan lebih mudah dianalisis.
  facet_wrap(~Benua) +  # Membagi scatter plot berdasarkan benua
#Fungsi labs() digunakan untuk menambahkan informasi pada grafik: title = "Angka Harapan Hidup vs Pendapatan per Kapita (Per Benua)" → Memberikan judul. x = "Pendapatan per Kapita (Log Scale)" → Label untuk sumbu X. y = "Angka Harapan Hidup" → Label untuk sumbu Y.
  labs(title = "Angka Harapan Hidup vs Pendapatan per Kapita (Per Benua)",
       x = "Pendapatan per Kapita (Log Scale)",
       y = "Angka Harapan Hidup") +
# Fungsi theme_minimal() digunakan untuk membuat tampilan grafik lebih bersih dan profesional.
  theme_minimal()
```

Sama seperti Grafik 2, tetapi dipecah berdasarkan Benua.
Dengan facet_wrap(~Benua), kita dapat melihat apakah hubungan Pendapatan per Kapita vs. Angka Harapan Hidup berbeda-beda di setiap benua.
Misalnya, di Eropa hubungan mungkin lebih kuat dibandingkan di Afrika, di mana terdapat lebih banyak variasi.
